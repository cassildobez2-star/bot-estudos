<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Super Calculadora Web</title>
<link rel="stylesheet" href="/static/style.css">
</head>
<body>
<div class="container">
<h2>Super Calculadora Web</h2>

<select id="operation" onchange="toggleInputs()">
  <option value="add">Adicionar</option>
  <option value="sub">Subtrair</option>
  <option value="mul">Multiplicar</option>
  <option value="div">Dividir</option>
  <option value="exp">Exponenciação</option>
  <option value="sqrt">Raiz Quadrada</option>
  <option value="fact">Fatorial</option>
  <option value="sin">Seno</option>
  <option value="cos">Cosseno</option>
  <option value="tan">Tangente</option>
  <option value="asin">Arco Seno</option>
  <option value="acos">Arco Cosseno</option>
  <option value="atan">Arco Tangente</option>
  <option value="matrix">Matriz</option>
  <option value="polynomial">Polinômio</option>
</select><br>

<div id="simple-inputs">
<input type="text" id="input1" placeholder="Número 1">
<input type="text" id="input2" placeholder="Número 2 (se necessário)">
</div>

<div id="matrix-inputs" style="display:none">
<p>Matriz A:</p>
<input type="text" id="A11" placeholder="A11"><input type="text" id="A12" placeholder="A12"><br>
<input type="text" id="A21" placeholder="A21"><input type="text" id="A22" placeholder="A22"><br>
<p>Matriz B:</p>
<input type="text" id="B11" placeholder="B11"><input type="text" id="B12" placeholder="B12"><br>
<input type="text" id="B21" placeholder="B21"><input type="text" id="B22" placeholder="B22"><br>
<select id="matrix-op">
  <option value="add">Adicionar</option>
  <option value="sub">Subtrair</option>
  <option value="mul">Multiplicar</option>
  <option value="det">Determinante</option>
</select>
</div>

<div id="polynomial-inputs" style="display:none">
<p>Coeficientes (ex: 1,2,3):</p>
<input type="text" id="coeffs">
<input type="text" id="poly-x" placeholder="Valor de x (opcional)">
<label><input type="checkbox" id="roots"> Encontrar raízes</label>
</div>

<button onclick="calculate()">Calcular</button>

<div class="result" id="result"></div>
</div>

<script>
function toggleInputs(){
    const op=document.getElementById("operation").value;
    document.getElementById("simple-inputs").style.display = ["add","sub","mul","div","exp","sqrt","fact","sin","cos","tan","asin","acos","atan"].includes(op)?"block":"none";
    document.getElementById("matrix-inputs").style.display = op=="matrix"?"block":"none";
    document.getElementById("polynomial-inputs").style.display = op=="polynomial"?"block":"none";
}

async function calculate(){
    const op=document.getElementById("operation").value;
    let payload={operation: op};

    if(["add","sub","mul","div","exp","sqrt","fact","sin","cos","tan","asin","acos","atan"].includes(op)){
        payload.x = parseFloat(document.getElementById("input1").value);
        payload.y = parseFloat(document.getElementById("input2").value) || 0;
    } else if(op=="matrix"){
        payload.A=[[parseFloat(document.getElementById("A11").value),parseFloat(document.getElementById("A12").value)],
                   [parseFloat(document.getElementById("A21").value),parseFloat(document.getElementById("A22").value)]];
        payload.B=[[parseFloat(document.getElementById("B11").value),parseFloat(document.getElementById("B12").value)],
                   [parseFloat(document.getElementById("B21").value),parseFloat(document.getElementById("B22").value)]];
        payload.matOp=document.getElementById("matrix-op").value;
    } else if(op=="polynomial"){
        payload.coeffs = document.getElementById("coeffs").value.split(",").map(Number);
        payload.x = parseFloat(document.getElementById("poly-x").value) || 0;
        payload.roots = document.getElementById("roots").checked;
    }

    try{
        const response = await fetch("/calculate",{
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body: JSON.stringify(payload)
        });
        const data = await response.json();
        document.getElementById("result").innerText = "Resultado: " + JSON.stringify(data.result);
    }catch(err){
        document.getElementById("result").innerText = "Erro na comunicação com servidor";
    }
}
</script>
</body>
      </html>
